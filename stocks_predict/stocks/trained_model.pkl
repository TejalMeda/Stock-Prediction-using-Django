import yfinance as yf
from datetime import datetime, timedelta
from sklearn.linear_model import LinearRegression
import joblib

def train_model(symbol, duration):

    # Calculate the start and end dates based on the duration
    end_date = datetime.now().strftime('%Y-%m-%d')
    start_date = (datetime.now() - timedelta(days=duration*365)).strftime('%Y-%m-%d')

    # Download stock data from Yahoo Finance
    stock_data = yf.download(symbol, start=start_date, end=end_date)

    # Prepare the data for training
    stock_data['Date'] = stock_data.index
    stock_data['Date'] = stock_data['Date'].map(datetime.toordinal)

    X = stock_data[['Date']].values
    y = stock_data['Close'].values

    # Create and train the model
    model = LinearRegression()
    model.fit(X, y)

    # Save the trained model to a file
    joblib.dump(model, 'trained_model.pkl')

def train_model_from_user_input():
    # Get user input for stock symbol and duration
    symbol = input("Enter stock symbol: ")
    duration = int(input("Enter duration in years: "))

    # Call the train_model function with user input
    train_model(symbol, duration)

# Call the train_model_from_user_input function to train the model using user input
train_model_from_user_input()
